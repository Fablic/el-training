<p id='notice'><%= notice %></p>

<h1><%= t('page.task.title.list') %></h1>

<% if @due_date_desc.blank? or @due_date_desc == 'false' %>
  <%= link_to t('page.task.due_date.desc'), controller: 'tasks', action: 'index', due_date_desc: true %>
<% else %>
  <%= link_to t('page.task.due_date.asc'), controller: 'tasks', action: 'index', due_date_desc: false %>
<% end %>

<br><br>

<%= form_tag({ :controller => 'tasks', :action => 'index' }, { :method => 'GET' }) do %>
  <%= select_tag 'status', options_for_select([[t('page.task.status.open'), 0],
                                               [t('page.task.status.inprogress'), 1],
                                               [t('page.task.status.done'), 2]]),
                                               prompt: t('page.task.status.prompt') %>
  <%= submit_tag t('page.task.link.search.status', id: :task_search_status) %>
<% end %>

<br>

<%= form_tag({ :controller => 'tasks', :action => 'index' }, { :method => 'GET' }) do %>
  <%= text_field_tag 'title' %>
  <%= submit_tag t('page.task.link.search.title', id: :task_search_title) %>
<% end %>

<br>

<table>
  <thead>
    <tr>
      <th><%= t('page.task.thead.title') %></th>
      <th><%= t('page.task.thead.description') %></th>
      <th><%= t('page.task.thead.due_date') %></th>
      <th><%= t('page.task.thead.priority') %></th>
      <th><%= t('page.task.thead.status') %></th>
      <th><%= t('page.task.thead.user') %></th>
      <th><%= t('page.task.thead.created_at') %></th>
      <th colspan='3'></th>
    </tr>
  </thead>

  <tbody>
    <% @tasks.each do |task| %>
      <tr>
        <td><b><%= task.title %></b></td>
        <td><%= task.description %></td>
        <td><%= task.due_date %></td>
        <td><%= priority_name(task.priority) %></td>
        <td><%= status_name(task.status) %></td>
        <td><%= task.user_id %></td>
        <td><%= task.created_at %></td>
        <td><%= link_to t('page.task.link.detail'), task %></td>
        <td><%= link_to t('page.task.link.edit'), edit_task_path(task) %></td>
        <td><%= link_to t('page.task.link.delete'), task, method: :delete, data: { confirm: t('dialog') } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to t('page.task.link.new'), new_task_path %>
