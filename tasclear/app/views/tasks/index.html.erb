<div class="title">
  <h1><%= link_to t('.title'), root_path %></h1>
</div>
<div class="row">
  <div class="card card-body bg-light search-box col-sm-10 col-xs-12">
    <%= form_tag(root_path, method: 'get') do %>
      <div class="row">
        <div class="form-group col-4">
          <%= label_tag :search_name, t('.search_name') %>
          <%= text_field_tag :search_name, params[:search_name], class:"form-control" %>
        </div>
        <div class="form-group col-3">
          <%= label_tag :search_status, t('.search_status') %>
          <%= select_tag :search_status, options_for_select( Task.statuses_i18n.invert ), include_blank: true, class:"form-control" %>
        </div>
        <div class="form-group col-3">
          <%= label_tag :search_label, t('.search_label') %>
          <%= select_tag :search_label, options_for_select( Label.all.map(&:name) ), include_blank: true, class:"form-control" %>
        </div>
        <div class="col-2">
          <%= submit_tag t('.search_submit'), class:"btn btn-primary search-btn" %>
        </div>
      </div>
    <% end %>
  </div>
  <div class="col-sm-2 col-xs-12">
    <%= link_to t('.new_task'), new_task_path, class:"btn btn-primary add-task" %>
  </div>
</div>
<div class="row">
  <div class="col-sm-9 col-xs-12">
    <table class="table table-striped">
      <tr class="table-primary">
        <th><%= t('.status') %></th>
        <th><%= link_sort(t('.priority'), 'priority') %></th>
        <th><%= link_sort(t('.deadline'), 'deadline') %></th>
        <th><%= t('.name') %></th>
        <th><%= t('.label') %></th>
        <th></th>
        <th></th>
        <th></th>
      </tr>
      <% @tasks.each do |task| %>
        <tr class="table-<%= border_color task.deadline if task.deadline.present? %>">
          <td><span class="badge badge-<%= status_color task.status %>"><%= task.status_i18n %></span></td>
          <td><span class="badge badge-<%= priority_color task.priority %>"><%= task.priority_i18n %></span></td>
          <td><%= l(task.deadline, format: :short2) if task.deadline.present? %></td>
          <td class='name'><%= task.name %></td>
          <td class='label'><% task.labels.each do |label| %>
            <span class="badge badge-info"><%= label.name %></span>
          <% end %></td>
          <td><%= link_to t('.detail'), task_path(task.id) %></td>
          <td><%= link_to edit_task_path(task.id), class:"edit-btn" do %>
            <i class="fa fa-edit"></i>
          <% end %></td>
          <td><%= link_to task_path(task.id), class:'delete-btn', method: :delete, data: {confirm: t('.confirm')} do %>
            <i class="fa fa-trash"></i>
          <% end %></td>
        </tr>
      <% end %>
    </table>

    <%= paginate @tasks %>
    <%= link_to t('.new_task'), new_task_path, class:"btn btn-primary" %>
  </div>
  <div class="col-sm-3 col-xs-12">
    <table class="table table-sm table-bordered kusa">
      <% (0..10).each do |i| %>
        <tr>
          <% (7*i..(7*i+6)).each do |j| %>
            <td class="table-<%= cell_color j %>">ã€€</td>
          <% end %>
        </tr>
      <% end %>
    </table>
  </div>
</div>
