<%= render 'flash' %>

<div>
  <h1>TYLE</h1>
  <%= link_to t('button.index'), tasks_path %>
  <%= link_to t('button.add'), new_task_path %>
</div>

<hr>

<div>
  <%= form_with url: tasks_path, local: true, html: { method: :get } do |f| %>
    <table>
      <tr>
        <td><%= f.label t('activerecord.attributes.task.name') %></td>
        <td>:</td>
        <td><%= f.text_field :name, value: params[:name], id: 'search_by_name' %></td>
      </tr>
      <tr>
        <td><%= f.label t('activerecord.attributes.task.priority') %></td>
        <td>:</td>
        <td><%= select_tag :priority, options_for_select(Task.priorities.map { |k, v| [t("enums.task.priority.#{k}"), v] }, selected: params[:priority]), prompt: t('operation.select.prompt'), id: 'search_by_priority' %></td>
      </tr>
      <tr>
        <td><%= f.label t('activerecord.attributes.task.status') %></td>
        <td>:</td>
        <td><%= select_tag :status, options_for_select(Task.statuses.map { |k, v| [t("enums.task.status.#{k}"), v] }, selected: params[:status]), prompt: t('operation.select.prompt'), id: 'search_by_status' %></td>
      </tr>
    </table>
    <div>
      <%= f.submit t('button.search') %>
    </div>
  <% end %>
</div>

<hr>

<div>
  <table>
    <caption><%= t('operation.task-list') %></caption>
    <tr>
      <th><%= t('activerecord.attributes.task.name') %></th>
      <th>
        <%= switch_asc_and_desc('priority', @sort_column, @sort_direction) %>
        <%= show_asc_or_desc('priority', @sort_column, @sort_direction) %>
      </th>
      <th>
        <%= switch_asc_and_desc('status', @sort_column, @sort_direction) %>
        <%= show_asc_or_desc('status', @sort_column, @sort_direction) %>
      </th>
      <th>
        <%= switch_asc_and_desc('due', @sort_column, @sort_direction) %>
        <%= show_asc_or_desc('due', @sort_column, @sort_direction) %>
      </th>
      <th>
        <%= switch_asc_and_desc('created_at', @sort_column, @sort_direction) %>
        <%= show_asc_or_desc('created_at', @sort_column, @sort_direction) %>
      </th>
      <th><%= t('button.detail') %></th>
    </tr>
    <% @tasks.each do |task| %>
      <tr>
        <td class="task-name"><%= task.name %></td>
        <td class="task-priority"><%= t("enums.task.priority.#{task.priority}") %></td>
        <td class="task-status"><%= t("enums.task.status.#{task.status}") %></td>
        <td class="task-due"><%= I18n.l(task.due) %></td>
        <td class="task-created-at"><%= I18n.l(task.created_at) %></td>
        <td><%= link_to t('activerecord.attributes.task.detail'), task_path(task.id) %></td>
      </tr>
    <% end %>
  </table>
  <%= paginate @tasks %>
</div>
