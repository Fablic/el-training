<h1><%= t('task.index.title') %></h1>

<div>
  <%= form_tag(root_path, method: :get, enforce_utf8: false) do %>
    <div>
      検索キーワード:
      <%= text_field_tag :q, params[:q], { size: 20 } %>
    </div>
    <div>
      ステータス:
      <%= select_tag :status, options_for_select(Task::STATUS.invert, :selected => params[:status]),  include_blank: '---' %>
    </div>
    <div>
      <%= submit_tag '検索', :name => nil %>
    </div>
  <% end %>
</div>

<table class="p-task-list">
  <thead>
    <tr>
      <th><%= t('activerecord.attributes.task.name') %></th>
      <th><%= t('activerecord.attributes.task.content') %></th>
      <th>
        <%= sortable("expire_date", t('activerecord.attributes.task.expire_date'), @search_task) %>
      </th>
      <th><%= t('activerecord.attributes.task.status') %></th>
      <th>
        <%= t('activerecord.attributes.task.created_at') %>
      </th>
      <th><%= t('action.table_heading_operation') %></th>
    </tr>
  </thead>
  <tbody>
    <% @tasks.each do |task| %>
      <tr>
        <td><%= task.name %></td>
        <td><%= task.content %></td>
        <td><%= l(task.expire_date.to_date) if task.expire_date.present? %></td>
        <td><%= Task::STATUS.fetch(task.status) %></td>
        <td><%= l(task.created_at.to_datetime) %></td>
        <td>
          <ul>
            <li><%= link_to t('action.show'), task_path(task) %></li>
            <li><%= link_to t('action.edit'), edit_task_path(task) %></li>
            <li><%= link_to t('action.delete'), task, method: :delete,
              data: { confirm: t('task.delete.confirm') } %></li>
          </ul>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
